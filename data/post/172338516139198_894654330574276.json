{"id":"172338516139198_894654330574276","from":{"name":"Muhammad Negm","id":"10212131509466411"},"message":"Hello, If anyone has some experience with Mongodb \nI have 2 user and foo. \nwhen I create a new foo it gets a user id.\nI end up with many foos belonging to the same user, I need to find a way to keep only one foo per user \"keeping the 2 collections convention\".\n\nI thought of creating a cron job to find the subtraction of the two sets but I think I wrote a really slow query...\n\nCan anyone help me for reaching a better way ?","actions":[{"name":"Comment","link":"https://www.facebook.com/172338516139198/posts/894654330574276"},{"name":"Like","link":"https://www.facebook.com/172338516139198/posts/894654330574276"},{"name":"Report Post to Admin","link":"https://www.facebook.com/groups/egyptian.geeks/members/"}],"privacy":{"value":"","description":"","friends":"","allow":"","deny":""},"type":"status","created_time":"2015-02-13T13:34:40+0000","updated_time":"2015-02-13T15:35:15+0000","is_hidden":false,"is_expired":false,"comments":{"data":[{"created_time":"2015-02-13T13:48:41+0000","from":{"name":"Islam AbdelMohaimen Hassan","id":"10211887209872216"},"message":"To solve this, I'd simply use a schema and define the user_id field in foo as unique.","can_remove":false,"like_count":0,"user_likes":false,"id":"894663530573356"},{"created_time":"2015-02-13T15:13:52+0000","from":{"name":"Muhammad Negm","id":"10212131509466411"},"message":"if it's unique it'll refuse the newly added fields","can_remove":false,"like_count":0,"user_likes":false,"id":"894692653903777"},{"created_time":"2015-02-13T15:14:43+0000","from":{"name":"Muhammad Negm","id":"10212131509466411"},"message":"The scenario is happening in MeteorJs using collectionsfs\nI am trying to add profile pictures to the users.\nI want it fast and async =D.","can_remove":false,"like_count":0,"user_likes":false,"id":"894692890570420"},{"created_time":"2015-02-13T15:17:14+0000","from":{"name":"Islam AbdelMohaimen Hassan","id":"10211887209872216"},"message":"I didn't use collectionsfs before, but I think the schema solution works in meteor too.","can_remove":false,"like_count":0,"user_likes":false,"id":"894693657237010"},{"created_time":"2015-02-13T15:18:30+0000","from":{"name":"Muhammad Negm","id":"10212131509466411"},"message":"there's unique for meteor, I didn't use it yet but I'll give it a spin \"I usually don't use schema in mongo\"\nbut seriously is there's another option?.\nBecause I read this file\nhttps://github.com/meteor/meteor/blob/devel/packages/accounts-base/accounts_server.js#L1136\n\nthis is accounts in Meteor and it seems that inserting with a uniqie will give and exception of duplicates, but I do want to replace immediately \"I don't want to remove the duplicate in try block\"","can_remove":false,"like_count":0,"user_likes":false,"id":"894693927236983"},{"created_time":"2015-02-13T15:21:53+0000","from":{"name":"Islam AbdelMohaimen Hassan","id":"10211887209872216"},"message":"I don't know if there's something more efficient, you can always query foo for objects containing user_id=x before creating new foo but I don't think that'd be an efficient solution.","can_remove":false,"like_count":0,"user_likes":false,"id":"894694717236904"},{"created_time":"2015-02-13T15:23:02+0000","from":{"name":"Muhammad Negm","id":"10212131509466411"},"message":"Islam AbdelMohaimen Hassan I thought of a cron job that runs daily cleaning the mess. \nbut I am in doubt of it's efficiency","can_remove":false,"like_count":0,"message_tags":[{"id":"10211887209872216","length":26,"name":"Islam AbdelMohaimen Hassan","offset":0,"type":"user"}],"user_likes":false,"id":"894695000570209"},{"created_time":"2015-02-13T15:29:21+0000","from":{"name":"Islam AbdelMohaimen Hassan","id":"10211887209872216"},"message":"I'm no expert, but IMHO I don't think the cron job solution will be efficient, I usually go for the most obvious and simple solution, that'd be the unique modifier or query for existing foos before creating a new one, or in this special case you can simply use meteor accounts and add a profile_pic field in the user.profile object.","can_remove":false,"like_count":0,"user_likes":false,"id":"894697153903327"},{"created_time":"2015-02-13T15:35:15+0000","from":{"name":"Muhammad Negm","id":"10212131509466411"},"message":"I already do that the issue is the redundant data \nI need to upload using collection fs \"It's the most customizable there\".\n\nI'll give the hooks a try","can_remove":false,"like_count":1,"user_likes":false,"id":"894699267236449"}],"paging":{"cursors":{"before":"WTI5dGJXVnVkRjlqZAFhKemIzSTZAPRGswTmpZAek5UTXdOVGN6TXpVMk9qRTBNak00TXpVek1qRT0ZD","after":"WTI5dGJXVnVkRjlqZAFhKemIzSTZAPRGswTmprNU1qWTNNak0yTkRRNU9qRTBNak00TkRFM01UVT0ZD"}}}}