{"id":"172338516139198_957897087583333","from":{"name":"Mohamed A. Baset","id":"1695725103775903"},"message":"This is the most weirdest vulnerability I've ever seen, The XSS payload got stored somehow in a cookie on ebay's remote server and I have exploited it without being logged in or even putting a payload on either GET or POST request and via a private browsing by just manipulating the referrer and the search string parameters which are stored in the cookie. It's pretty obvious that they're storing the referrers and the search history strings in their database unsanitized.\n\n","story":"Mohamed A. Baset shared a link to the group: Egyptian Geeks.","story_tags":{"0":[{"id":"1695725103775903","name":"Mohamed A. Baset","type":"user","offset":0,"length":16}],"45":[{"id":"172338516139198","name":"Egyptian Geeks","type":"group","offset":45,"length":14}]},"picture":"https://fbexternal-a.akamaihd.net/safe_image.php?d=AQDfblAfFurkDBBS&w=130&h=130&url=http%3A%2F%2Fi.ytimg.com%2Fvi%2F6Ivy1_8WwkE%2Fmaxresdefault.jpg&cfs=1&_nc_hash=AQCNZawLlX34uCqG","link":"https://www.youtube.com/watch?v=6Ivy1_8WwkE&feature=youtu.be","source":"https://www.youtube.com/embed/6Ivy1_8WwkE?autoplay=1","name":"eBay Weirdest Stored Cookie XSS vulnerability ever seen.","caption":"youtube.com","description":"Description","icon":"https://www.facebook.com/images/icons/post.gif","actions":[{"name":"Comment","link":"https://www.facebook.com/172338516139198/posts/957897087583333"},{"name":"Like","link":"https://www.facebook.com/172338516139198/posts/957897087583333"},{"name":"Report Post to Admin","link":"https://www.facebook.com/groups/egyptian.geeks/members/"}],"privacy":{"value":"","description":"","friends":"","allow":"","deny":""},"type":"video","status_type":"shared_story","created_time":"2015-06-13T09:09:27+0000","updated_time":"2015-06-13T22:06:42+0000","is_hidden":false,"is_expired":false,"likes":{"data":[{"id":"10155071713202292","name":"Hassan Aly Selim"},{"id":"1799143340406795","name":"صصحح يافار"},{"id":"709206249239999","name":"Osama Soliman"},{"id":"10158483817400314","name":"Mohamed Elsherif"},{"id":"10211135002706823","name":"Ahmad Abubakr"},{"id":"1424757227568482","name":"Mohamed K. Fathy"},{"id":"10155252594718081","name":"Ahmed Zain Mohammed"},{"id":"1496732523694038","name":"Ahmed Yousef"},{"id":"1102075766605709","name":"Diaa Elsayed"},{"id":"1526545357358228","name":"Ahmed Youssef"},{"id":"10210172372078534","name":"Abdelrhman Shawky"},{"id":"10155955831035299","name":"Eslam Salem Mahmoud"},{"id":"715713385273130","name":"Ahmad Magdy"},{"id":"1596622790352478","name":"Ahmed Mousa"},{"id":"1822709031088736","name":"Mostafa Kasem"},{"id":"10158378381465387","name":"Mahmoud M. Abdel-Fattah"},{"id":"1546261478740568","name":"Diaa Diab"}],"paging":{"cursors":{"before":"MTAxNTUwNzE3MTMyMDIyOTIZD","after":"MTU0NjI2MTQ3ODc0MDU2OAZDZD"}}},"comments":{"data":[{"created_time":"2015-06-13T09:20:26+0000","from":{"name":"Ahmad Alfy","id":"10154097389365670"},"message":"wow!","can_remove":false,"like_count":1,"user_likes":false,"id":"957899094249799"},{"created_time":"2015-06-13T09:27:30+0000","from":{"name":"Diaa Diab","id":"1546261478740568"},"message":"لا لا لا لا تعلالى بقى كدا :v","can_remove":false,"like_count":1,"user_likes":false,"id":"957900284249680"},{"created_time":"2015-06-13T09:31:18+0000","from":{"name":"Mohamed A. Baset","id":"1695725103775903"},"message":":D","can_remove":false,"like_count":0,"user_likes":false,"id":"957900997582942"},{"created_time":"2015-06-13T09:32:03+0000","from":{"name":"Diaa Diab","id":"1546261478740568"},"message":"هتيجى بابلك ولا برايفت .... من الأخر يعنى :v","can_remove":false,"like_count":0,"user_likes":false,"id":"957901074249601"},{"created_time":"2015-06-13T09:37:45+0000","from":{"name":"Mohamed A. Baset","id":"1695725103775903"},"message":"براحتك، ولو النقاش هيبقى تيكنيكال خلينا هنا والناس تستفيد :D بس طبعا اللى يريحك","can_remove":false,"like_count":3,"user_likes":false,"id":"957901924249516"},{"created_time":"2015-06-13T09:40:14+0000","from":{"name":"Diaa Diab","id":"1546261478740568"},"message":"\"I have exploited it without being logged in\" أيه بقى يا كبير الكلام دا علشان انا مش واخد بالى من السيناريو صراحه !!","can_remove":false,"like_count":0,"user_likes":false,"id":"957902797582762"},{"created_time":"2015-06-13T09:48:14+0000","from":{"name":"Mohamed A. Baset","id":"1695725103775903"},"message":"الموضوع بدأ انى مكنتش داخل عندى نية خالص انى اهنت، بدور على موبايل وكدا، فقولت اشوف ال Search bar نظامة ايه فحطيت فيه ال Payload اللى انت شوفتها فى الفيديو وبالتأكيد المكان دا مهروس مليون لا مليون ايه، مليار مره وبالتأكيد مفهوش اى vulnerability وطلعت شكوكى فى محلها، مفيش اى شئ حصل، شويه وانا بعمل browsing وبدور فى صفحة النتايج عن الموبايل ولقيت ال confirm dialog الخاص بال payload اللى حطيته ظهرلى فجأه، قولت اشوف الموضوع جايز يكون الصفحه اللى انا فيها دى مصابه ب Stored XSS مثلا فى كومنت فى اى حاجه، عملت سيرش فى كل ال elements الموجوده فى الصفحه مفيش اى شئ باين انه injected بواسطة اى يوزر، عملت Dump للركوست وروحت بيه على Burp زى مانت شوفت فى الفيديو مفيش اى post ولا get ركوست فيهم اى payloads وكررت الركوست على كل البروازرات الموجوده عندى لقيته لسه بيعمل ال confirm alert الخاص بال payload ساعتها حاولت اعمل reproduce علشان ابلغ فمعرفتش، استنيت شويه، كررت نفس الكلام اللى عملته بشكل تانى بردو مفيش، بصيت شوية فى الكوكى بتاعتهم لقيتهم بيتخزن فيها ال referrer اللى كان قبل الصفحه اللى انت موجود فيها وحتى كمان الاسترنج اللى انت بحثت عنه بشكل مشفر فتأكدت ساعتها ان ال payload اتخزن فى الكوكى، وبالتالى اتخزن فى الداتابيز، بعتلهم وقولتلهم عايز شرح للى حصل دا لأنى انا عن نفسى مش فاهم ايه اللى خلف الكواليس فقالولى السبب اللى وضحتهولك انهم بيخزنوا الرفيرير والسيرش سترينج عندهم فى الداتابيز علشان لو دخلت صفحه تانيه يعملوا Customization لل Content بناء على اللى كنت بتعمله قبل كدا، بس للاسف كانوا بيخزنوا ويسترجعوا ال strings دى بدون اى فلتره","can_remove":false,"like_count":8,"user_likes":false,"id":"957903994249309"},{"created_time":"2015-06-13T09:53:21+0000","from":{"name":"Diaa Diab","id":"1546261478740568"},"message":"opsss, يعنى دى سيلف أكس أس أس 100% مظبوط كدا ؟","can_remove":false,"like_count":1,"user_likes":false,"id":"957905257582516"},{"created_time":"2015-06-13T10:05:45+0000","from":{"name":"Mohamed A. Baset","id":"1695725103775903"},"message":"سيلف لما اكون لوجد ان عالاقل :D\nانا اديت ال Request Dump بالكوكى وكل شئ لحد تانى واكد انها شغاله، فلو صادفت والكوكى دى بقت عند حد بأى Escalation بشكل ما هتبقى كارثه","can_remove":false,"like_count":0,"user_likes":false,"id":"957908564248852"},{"created_time":"2015-06-13T22:00:45+0000","from":{"name":"Mohamed A. Baset","id":"1695725103775903"},"message":"Diaa Diab \nصدقنى انا عن نفسى مستغرب جدا بسببها لدرجة انى طلبت منهم ال Technical Details اللى حصلت فى ال Backend  :D","can_remove":false,"like_count":1,"message_tags":[{"id":"1546261478740568","length":9,"name":"Diaa Diab","offset":0,"type":"user"}],"user_likes":false,"id":"958122317560810"},{"created_time":"2015-06-13T22:04:31+0000","from":{"name":"Diaa Diab","id":"1546261478740568"},"message":"Asly ya symbian ;)","can_remove":false,"like_count":1,"user_likes":false,"id":"958122847560757"},{"created_time":"2015-06-13T22:06:42+0000","from":{"name":"Mohamed A. Baset","id":"1695725103775903"},"message":"حبيبي :)","can_remove":false,"like_count":0,"user_likes":false,"id":"958123144227394"}],"paging":{"cursors":{"before":"WTI5dGJXVnVkRjlqZAFhKemIzSTZAPVFUzT0RrNU1EazBNalE1TnprNU9qRTBNelF4T0RjeU1qWT0ZD","after":"WTI5dGJXVnVkRjlqZAFhKemIzSTZAPVFU0TVRJek1UUTBNakkzTXprME9qRTBNelF5TXpNeU1EST0ZD"}}}}