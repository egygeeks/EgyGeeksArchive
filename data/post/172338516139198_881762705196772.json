{"id":"172338516139198_881762705196772","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"الوضع كالتالي :D\n\nمن كام يوم بدأنا نستعمل Ansible بشكل فعلي في الشغل (واللي ميعرفش أنسيبل إيه هو عبارة عن Configuration management tool).\nوكان في حاجة معينة -صغيرة بس مهمة- عاوزينها بس مكانتش موجودة فيه، فعملت موديول ليه بباش في خمس دقايق.\n \n \nأنسيبل فيه ملف inventory بيكون فيه متقسم السرفرات لمجموعات عشان لو عاوز تنفذ حاجة معينة على مجموعة معينة من المجموعات.\nملفات الإنفينتوري بيكون شكله حاجة زي التالي:\n\n[group1]\nmember1\nmember2\nmember3\n \n \n[group3]\nmember1\nmember2\nmember3\n \n \n[group3]\nmember1\nmember2\nmember3\n \n \nاللي المفروض يعمله الموديول إنه بيطلع الجروبز بس في شكل json.\n \n \nالموديول بالباش هنا (دي كانت النسخة الأولية، حالياً السكربت بيطلع كل جروب فيه كام ميمبر).\nhttps://gist.github.com/AAbouZaid/066a3e5e026c599ec196\n \n \nبعد كدا قولت أروش على نفسي شوية وأكتبه بـ AWK بس بدون أي Bash :D\nعملت نفس النسخة من الموديويل في ١٠ دقايق وموجود هنا:\nhttps://gist.github.com/AAbouZaid/abf6f95bfb0fa1196dbe\n \n \nانهاردة قررت أروش على نفسي أكتر وأجرب أكتب أول بايثون سكربت :D\nفعلياً أنا معملتش أي حاجة قبل كدا ببايثون ولا حتى خلصت قراية فيه، بس عملت بالشوية اللي عارفهم يعني :D والنتيجة كانت التالي:\nhttps://gist.github.com/AAbouZaid/82c6085cccbd1b0deb3c\n \n \nدي أفضل طريقة \"نضيفة\" وصلت ليها لإن الغرض إن الموضوع يتعمل بنضافة مش مجرد النتيجة النهائية :D\n \n \nأنا sysadmin مسكين بعمل أي حاجة عاوزها بباش أياً كانت إيه هي ... لكن حابب أدوس أكتر في بايثون :D\nلو حد عنده طرق أكتر نضافة واختصاراً من الكود اللي مكتوب هيكون شيء عظيم إني أسمع منه :D \nيعني بدور ازاي أعمل ده بطريقة more pythonic :D","story":"Ahmed M. AbouZaid shared a link to the group: Egyptian Geeks.","story_tags":{"0":[{"id":"10158193077815618","name":"Ahmed M. AbouZaid","type":"user","offset":0,"length":17}],"46":[{"id":"172338516139198","name":"Egyptian Geeks","type":"group","offset":46,"length":14}]},"picture":"https://fbexternal-a.akamaihd.net/safe_image.php?d=AQD1hV4llB2nbG9j&w=130&h=130&url=https%3A%2F%2Favatars1.githubusercontent.com%2Fu%2F6760103%3Fs%3D140&cfs=1&sx=0&sy=0&sw=140&sh=140&_nc_hash=AQAzdWAZhf259chn","link":"https://gist.github.com/AAbouZaid/066a3e5e026c599ec196","name":"AAbouZaid/Ansible module to list groups in inventory.","caption":"gist.github.com","description":"- Gist is a simple way to share snippets of text and code with others.","icon":"https://www.facebook.com/images/icons/post.gif","actions":[{"name":"Comment","link":"https://www.facebook.com/172338516139198/posts/881762705196772"},{"name":"Like","link":"https://www.facebook.com/172338516139198/posts/881762705196772"},{"name":"Report Post to Admin","link":"https://www.facebook.com/groups/egyptian.geeks/members/"}],"privacy":{"value":"","description":"","friends":"","allow":"","deny":""},"type":"link","status_type":"shared_story","created_time":"2015-01-16T17:36:05+0000","updated_time":"2015-01-17T21:26:31+0000","is_hidden":false,"is_expired":false,"likes":{"data":[{"id":"10154871355735944","name":"Tarek Amr"},{"id":"10155072632194747","name":"Radwa Kamal"},{"id":"10155224979338825","name":"Mostafa Sakr"},{"id":"1684133215219885","name":"Ali Saber"},{"id":"10154838763611066","name":"Shady M. Najib"},{"id":"10212068301119909","name":"Ali El-Wafdy"},{"id":"1088031311307136","name":"Mohammad Sakr"},{"id":"10154942637951276","name":"Ahmad Gamaleldin Hassanein"},{"id":"10211887209872216","name":"Islam AbdelMohaimen Hassan"},{"id":"10158315926405433","name":"Mahmoud M. El-Safty"},{"id":"1829457323960362","name":"Galal Aly"},{"id":"10154911720956083","name":"Abdallah Hodieb"},{"id":"10155040034611904","name":"Elsharnouby Mohamed"}],"paging":{"cursors":{"before":"MTAxNTQ4NzEzNTU3MzU5NDQZD","after":"MTAxNTUwNDAwMzQ2MTE5MDQZD"}}},"comments":{"data":[{"created_time":"2015-01-16T18:07:28+0000","from":{"name":"Elsharnouby Mohamed","id":"10155040034611904"},"message":"I think you can post it too on code review on stackexchange","can_remove":false,"like_count":1,"user_likes":false,"id":"881773875195655"},{"created_time":"2015-01-16T18:09:30+0000","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"لا يا عم شرنو أنا لسه غلبان xD","can_remove":false,"like_count":1,"user_likes":false,"id":"881774495195593"},{"created_time":"2015-01-16T18:09:49+0000","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"لكن فكرة عظيمة :D","can_remove":false,"like_count":0,"user_likes":false,"id":"881774568528919"},{"created_time":"2015-01-16T18:14:54+0000","from":{"name":"Elsharnouby Mohamed","id":"10155040034611904"},"message":"I think they know they're reviewing. So I suppose they're not harsh as stackoverflow :-D","can_remove":false,"like_count":1,"user_likes":false,"id":"881776441862065"},{"created_time":"2015-01-16T18:15:54+0000","from":{"name":"Elsharnouby Mohamed","id":"10155040034611904"},"message":"I did read some of python code reviews there and they were awesome, although I don't remember that much now","can_remove":false,"like_count":1,"user_likes":false,"id":"881776841862025"},{"created_time":"2015-01-16T18:49:09+0000","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"هجرب أضيف الحته بتاعت عد الميمبرز في كل جروب وابوسته هناك :D","can_remove":false,"like_count":1,"user_likes":false,"id":"881787145194328"},{"created_time":"2015-01-16T19:10:21+0000","from":{"name":"Abdallah Hodieb","id":"10154911720956083"},"message":"This is not exactly a review because im not that good yet :D  but those are some suggestions :\n\nUsing \"with\" when dealing with files is always a good idea.\n\nhttps://www.python.org/dev/peps/pep-0343/\n\nAlso when iterating on the file lines you don't need to read lines before iterating on them. \n\nExample:\n\nwith open('file.config') as f:\n      for line in f: \n           print line","can_remove":false,"like_count":2,"user_likes":false,"id":"881793358527040"},{"created_time":"2015-01-16T19:23:34+0000","from":{"name":"Mohammad Tayseer","id":"10154965677956341"},"message":"I'll write this post in English, to keep the LTR layout\n\nThe code can be greatly simplified if you make small modifications to your regex & handle the file as a whole, instead of for-loop for each line\n\nAlso I changed it to read the path to ansible.cfg as a command-line parameter\n\nhttps://gist.github.com/mtayseer/b94a5f436a9433a71d55","can_remove":false,"like_count":3,"user_likes":false,"id":"881797311859978"},{"created_time":"2015-01-16T19:25:10+0000","from":{"name":"Ahmed Al-Amir","id":"10155179919799180"},"message":"I have no idea what is happening here, but I love how Tayseer simplified the python code.","can_remove":false,"like_count":1,"message_tags":[{"id":"10154965677956341","length":7,"name":"Mohammad Tayseer","offset":54,"type":"user"}],"user_likes":false,"id":"881797958526580"},{"created_time":"2015-01-16T19:57:27+0000","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"Abdallah Hodieb\nأنا شوفت with فعلاً بس مفهمتهاش أوي ففوتها :D\n\nMohammad Tayseer\nكم أنت برنس :D هو ده بالظبط اللي بتكلم فيه :D\nلإن كدا الكود بتاعي بقى أكبر من باش وده ميصحش يعني 😂\n\nهي في مشكلة وحيدة ... كنت بجرب إذا كان في ملف الكونفجريشن أكتر من سطر بيبدأ بـ hostfile أو حتى متهيش.\n\nالتعديل بتاعك مش بيشتغل لو في سطر أوله hostfile متهيش .. يعني زي كدا\n#hostfile\n\nجربت أعمل.\nhosts_file = re.findall(\"^hostfile\\s*=\\s*(.*)\", ansible_conf_file)\n\nبردو بس مشتغلش ... بيطلع نتيجة فاضية \"[]\"","can_remove":false,"like_count":0,"message_tags":[{"id":"10154911720956083","length":15,"name":"Abdallah Hodieb","offset":0,"type":"user"},{"id":"10154965677956341","length":16,"name":"Mohammad Tayseer","offset":63,"type":"user"}],"user_likes":false,"id":"881808091858900"},{"created_time":"2015-01-16T20:26:25+0000","from":{"name":"Mohammad Tayseer","id":"10154965677956341"},"message":"غريبة. لما أنا جربت اشتغل معايا. ممكن تعمل كومنت علي gist وتحط هناك sample؟","can_remove":false,"like_count":0,"user_likes":false,"id":"881816978524678"},{"created_time":"2015-01-16T20:38:30+0000","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"Mohammad Tayseer\nحطيت الإيرور اللي بيطلع، وشكل الكونفجريشن :‑)","can_remove":false,"like_count":0,"message_tags":[{"id":"10154965677956341","length":16,"name":"Mohammad Tayseer","offset":0,"type":"user"}],"user_likes":false,"id":"881820408524335"},{"created_time":"2015-01-16T21:01:28+0000","from":{"name":"Mohammad Tayseer","id":"10154965677956341"},"message":"اللي أنا فهمته من كلامك غير المشكلة :)\nأنا عدلت الكود ودلوقتي بيشتغل صح. اللي إنت عملته (إنك تزود \"^\") ده جزء من الحل. اقرأ في الـ re بتاع بايثون هتلاقيه بيشرح كل حاجة\nhttps://gist.github.com/mtayseer/b94a5f436a9433a71d55","can_remove":false,"like_count":0,"user_likes":false,"id":"881826808523695"},{"created_time":"2015-01-16T22:01:49+0000","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"Mohammad Tayseer\nمعلش لسه على قدي خالص :D\n\nعموماً ده كان الهدف الأساسي من السكربت ... إنه يجيب عدد الجروبز وعدد اللي جواها.\n\nدي كانت النتيجة بعد ملاحظات الناس البرنسيين :D\nhttps://gist.github.com/AAbouZaid/758ba28e4e4f6f753750\n\nالجزء الجديد بتاع العد ده مش عارف إذا كان ليه طريقة ظريفة زي اللي عملتلها ولا لأ بس هكون سعيد لو في ( حاسه لسه مدي على بيرل وباش :D )\n\nوفي مثال على النتيجة اللي بيطلعها في الجيستاية :D","can_remove":false,"like_count":0,"message_tags":[{"id":"10154965677956341","length":16,"name":"Mohammad Tayseer","offset":0,"type":"user"}],"user_likes":false,"id":"881844718521904"},{"created_time":"2015-01-16T23:07:21+0000","from":{"name":"Mohammad Tayseer","id":"10154965677956341"},"message":"I updated my scripts again. I'm using the dict itself for counting https://gist.github.com/mtayseer/b94a5f436a9433a71d55\n\nAnother way of doing this is using ansible itself http://docs.ansible.com/playbooks_variables.html#magic-variables-and-how-to-access-information-about-other-hosts","can_remove":false,"like_count":1,"user_likes":false,"id":"881868828519493"},{"created_time":"2015-01-17T12:52:04+0000","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"ـ\nMohammad Tayseer\nكدا الكود بقى ظريف جداً فعلاً :D استخدام variable عشان يعد حركة باشي جداً :D\nمش متعود لسه على الأنواع التانية من الداتا زي الـ dicts :D\n\nالنقطة الوحيدة اللي مش قادر أفهمها على وجه الدقة الحتة بتاعت السطور الفاضية ... مش فاهم الاكسبرشن بتاع if not ازاي بيفوت السطور الفاضية؟ :D","can_remove":false,"like_count":0,"message_tags":[{"id":"10154965677956341","length":16,"name":"Mohammad Tayseer","offset":2,"type":"user"}],"user_likes":false,"id":"882098451829864"},{"created_time":"2015-01-17T13:01:11+0000","from":{"name":"Ahmed M. AbouZaid","id":"10158193077815618"},"message":"ـ\nMohammad Tayseer\nوصحيح ... اللينك بتاع دوكمنتيشن أنسيبل بيتكلم عن جوا الـ playbook نفسه -سكربتات أنسيبل- مش من الكوماند لاين وده اللي معمول عشانه الموديول.\n\nيعني بديل للأوبشن --list-hosts لكن للجروبز ... حاجة زي كدا\nansible localhost -m listgroups","can_remove":false,"like_count":0,"message_tags":[{"id":"10154965677956341","length":16,"name":"Mohammad Tayseer","offset":2,"type":"user"}],"user_likes":false,"id":"882102198496156"},{"created_time":"2015-01-17T21:26:31+0000","from":{"name":"Mohammad Tayseer","id":"10154965677956341"},"message":"strip() removes whitespaces. Python treats empty strings as false values.","can_remove":false,"like_count":1,"user_likes":false,"id":"882355341804175"}],"paging":{"cursors":{"before":"WTI5dGJXVnVkRjlqZAFhKemIzSTZAPRGd4Tnpjek9EYzFNVGsxTmpVMU9qRTBNakUwTXpFMk5EZAz0ZD","after":"WTI5dGJXVnVkRjlqZAFhKemIzSTZAPRGd5TXpVMU16UXhPREEwTVRjMU9qRTBNakUxTWprNU9URT0ZD"}}}}